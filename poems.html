<!DOCTYPE html>
<html>
<head>
  <title>Random vers</title>
  <style>
    body {
  background-color: lightblue;
        }
    button {
      box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 10px 0 rgba(0,0,0,0.19);
      border-radius: 12px;
      width: 10%;
    }
    button:hover {
      box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 20px 0 rgba(0,0,0,0.19);
      border-radius: 12px;
      width: 10%;
    }
    h1 {
      text-align: center;
    }
    pre {
      text-align: center;
    }
    div {
      font-family: Calibri;
      font-size: 16px;
      margin:30px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Véletlen vers</h1>
  <div><button type="button" onclick="logPoem()">Mutass egy verset</button></div>
  <div><button type="button" onclick="fetchMovies()">Mutass egy konyvet</button></div>
    <div><button type="button" onclick="fetchMoviesJSON()">Mutass egy konyvetJSON</button></div>
   <div id="author"></div>
  <div id="title"></div>
  <pre id="poem"></pre>
  <div id="likeButtonContainer"></div>
  <div id="gifContainer"></div>

  <script>
  
const express = require('express');
const app = express();
// Add this middleware before your routes to enable CORS
app.use((req, res, next) => {
  res.setHeader('Access-Control-Allow-Origin', 'https://extinct-jade-bedclothes.cyclic.app');
  // You can set other CORS headers as needed, e.g., for handling different HTTP methods or headers.
  // For simplicity, I'm allowing all methods and headers here (*), but you can be more restrictive.
  res.setHeader('Access-Control-Allow-Methods', '*');
  res.setHeader('Access-Control-Allow-Headers', '*');
  next();
});

  app.listen(() => {
  console.log('Server is running.');
});



    
  async function fetchMoviesJSON() {
  const response = await fetch('https://extinct-jade-bedclothes.cyclic.app/', {
  method: 'GET',
    mode: 'cors',
    headers: {
    'Content-Type': 'application/json',
      'Access-Control-Allow-Origin': *
  }
  })
  const movies = await response.json();
  return movies;
    console.log(movies+'json')
    console.log(1);
}

fetchMoviesJSON().then(movies => {
  movies; // fetched movies
});
    console.log(movies);
    console.log(movies.title);

async function fetchMovies() {
  const response = await fetch('https://extinct-jade-bedclothes.cyclic.app');
  // waits until the request completes...
  console.log(response+'response');
   console.log(2);
}

 
    

    
    function get_poems_from_file(file_path) {
      try {
        var file = new XMLHttpRequest();
        file.open("GET", file_path, false);
        file.send(null);
        var poems = JSON.parse(file.responseText);
        return poems;
      } catch (error) {
        console.error("Error loading poems:", error);
        return [];
      }
    }

    function getRandomPoem(poems) {
      if (poems.length > 0) {
        var randomIndex = Math.floor(Math.random() * poems.length);
        return poems[randomIndex];
      } else {
        return null;
      }
    }

    function logPoem() {
      var poems = get_poems_from_file("poems.json");
      var authorElement = document.getElementById("author");
      var titleElement = document.getElementById("title");
      var poemElement = document.getElementById("poem");
      var likeButtonContainer = document.getElementById("likeButtonContainer");
      var gifContainer = document.getElementById("gifContainer");

      // Delete all previous entries
      authorElement.innerHTML = "";
      titleElement.innerHTML = "";
      poemElement.textContent = "";
      likeButtonContainer.innerHTML = "";
      gifContainer.innerHTML = "";

      var poem = getRandomPoem(poems);
      if (poem) {
        var author = poem.author;
        var title = poem.title;
        var content = poem.content;
        authorElement.innerHTML = "Szerző: " + author;
        titleElement.innerHTML = "Cím: " + title;
        poemElement.textContent = content;

        // Create "Like" button
        var likeButton = document.createElement("button");
        likeButton.textContent = "Tetszik";
        likeButton.addEventListener("click", showGif);
        likeButtonContainer.appendChild(likeButton);
      } else {
        console.error("No poems found in the list.");
        poemElement.textContent = "Nincs elérhető vers.";
      }
    }

  function showGif() {
          const gifUrl = "https://media.tenor.com/DBFq-CWWkGoAAAAC/baby-booty.gif"; // Replace with your own GIF URL

          // Hide "Like" button
          document.getElementById("likeButtonContainer").style.display = "none";

          // Clear previous GIF
          document.getElementById("gifContainer").innerHTML = "";

          // Create GIF element
          const gifElement = document.createElement("img");
          gifElement.src = gifUrl;

          document.getElementById("gifContainer").appendChild(gifElement);
        }

    logPoem();
  </script>
 
</body>
</html>
